---
import Layout from '../layouts/Layout.astro';
import Hero from '../components/Hero.astro';
import ContactSection from '../components/ContactSection.astro';
import TallerCard from '../components/TallerCard.astro';
import ComunidadCard from '../components/ComunidadCard.astro';
import { getCollection } from 'astro:content';

// Obtener datos
const talleres = (await getCollection('talleres')).sort((a, b) => a.data.orden - b.data.orden);
const comunidad = (await getCollection('comunidad'))
  .filter(item => item.data.destacado)
  .sort((a, b) => a.data.orden - b.data.orden);
---

<Layout title="CIArte – El Laberinto | Espacio de Arte Comunitario">
  <main>
    <Hero />

    <!-- SECCIÓN QUÉ ES CIARTE -->
    <section class="section about-section" id="ciarte">
      <div class="container">
        <div class="grid-2 about-grid">
          <div class="about-content">
            <h2 class="section-title text-left">Qué es CIArte</h2>
            <p class="lead">
              Un espacio donde el arte se encuentra con la comunidad, las generaciones se abrazan y la cultura florece.
            </p>
            <p>
              CIArte (Centro de Integración y Arte) funciona en el corazón del Centro de Jubilados Los Olivos. 
              Es coordinado por <strong class="text-primary">El Laberinto Grupo de Teatro Independiente</strong>, 
              con 19 años de trayectoria y una visión clara: el arte es un derecho y una herramienta de transformación social.
            </p>
            <p>
              Aquí no solo enseñamos disciplinas artísticas; construimos comunidad, 
              fomentamos el encuentro entre abuelos y nietos, y mantenemos viva nuestra identidad cultural.
            </p>
          </div>
          <div class="about-image">
             <img src="/images/gallery-6.jpg" alt="Actividades en CIArte" class="rounded-image" />
          </div>
        </div>
      </div>
    </section>

    <!-- SECCIÓN AGENDA -->
    <section class="section bg-dark text-white" id="agenda">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title text-accent">Agenda Cultural</h2>
          <p class="section-subtitle text-white-50">
            Próximos eventos, funciones y muestras. ¡Agendalo!
          </p>
        </div>

        <div class="grid-3">
          <article class="card agenda-card">
            <div class="card-image">
              <img src="/images/flayer-invitado.jpg" alt="Evento Especial con Invitado" loading="lazy" />
            </div>
            <div class="card-content">
              <h3 class="card-title text-accent">Visita Especial</h3>
              <p>Un encuentro único con referentes de la cultura.</p>
              <div style="text-align: center; margin-top: auto;">
                <a href="https://wa.me/543874535157?text=Hola, quiero reservar entrada para la Visita Especial" class="btn btn-outline mt-4" target="_blank">Comprar Entrada Ya</a>
              </div>
            </div>
          </article>

          <article class="card agenda-card">
             <div class="card-image">
              <img src="/images/flayer-muestradebateria.jpg" alt="Muestra de Batería" loading="lazy" />
            </div>
            <div class="card-content">
              <h3 class="card-title text-accent">Muestra de Percusión</h3>
              <p>Todo el ritmo y la energía de nuestros alumnos en escena.</p>
              <div style="text-align: center; margin-top: auto;">
                <a href="https://wa.me/543874535157?text=Hola, quiero comprar entrada para la Muestra de Batería" class="btn btn-outline mt-4" target="_blank">Comprar Entrada Ya</a>
              </div>
            </div>
          </article>

          <article class="card agenda-card">
             <div class="card-image">
              <img src="/images/obra1.jpg" alt="Obra de Teatro" loading="lazy" />
            </div>
             <div class="card-content">
              <h3 class="card-title text-accent">Función Teatral</h3>
              <p>Nueva obra del grupo El Laberinto. ¡No te la pierdas!</p>
              <div style="text-align: center; margin-top: auto;">
                 <a href="https://wa.me/543874535157?text=Hola, quiero comprar entrada para la Función de Teatro" class="btn btn-outline mt-4" target="_blank">Comprar Entrada Ya</a>
              </div>
            </div>
          </article>
        </div>
      </div>
    </section>



    <!-- SECCIÓN TALLERES -->
    <section class="section bg-light" id="talleres">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Nuestros Talleres</h2>
          <p class="section-subtitle">
            Espacios de aprendizaje y creación para todas las edades. ¡Sumate!
          </p>
        </div>

        <div class="grid-3">
          {talleres.map(taller => (
            <TallerCard taller={taller} />
          ))}
        </div>
      </div>
    </section>

    <!-- SECCIÓN COMUNIDAD / AGENDA -->
    <section class="section" id="comunidad">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Vida Comunitaria</h2>
          <p class="section-subtitle">
            Más allá de los talleres, compartimos encuentros, celebraciones y proyectos colectivos.
          </p>
        </div>

        <div class="grid-3">
          {comunidad.map(actividad => (
            <ComunidadCard actividad={actividad} />
          ))}
        </div>
      </div>
    </section>

    <!-- SECCIÓN GALERÍA -->
    <section class="section bg-dark text-white" id="galeria">
      <div class="container">
        <h2 class="section-title text-white">Galería</h2>
        <p class="section-subtitle text-white-50">Momentos que construyen nuestra historia.</p>
        
        <div class="gallery-grid">
          <div class="gallery-item item-1">
            <img src="/images/muestra-percusion2.jpg" alt="Muestra de percusión" loading="lazy" />
          </div>
          <div class="gallery-item item-2">
             <img src="/images/gallery-2.jpg" alt="Muestra de música" loading="lazy" />
          </div>
          <div class="gallery-item item-3">
             <img src="/images/gallery-3.jpg" alt="Percusión" loading="lazy" />
          </div>
          <div class="gallery-item item-4">
             <img src="/images/gallery-4.jpg" alt="Evento comunidad" loading="lazy" />
          </div>
          <div class="gallery-item item-5">
             <img src="/images/gallery-5.jpg" alt="Invitados" loading="lazy" />
          </div>
        </div>
      </div>
    </section>

    <ContactSection />
  </main>
</Layout>

<style>
  .text-left { text-align: left; }
  
  /* Mobile: Center title */
  @media (max-width: 768px) {
    .section-title.text-left {
      text-align: center;
    }
    
    .about-content {
      text-align: center;
    }
  }
  
  .text-primary { color: var(--color-primary-500); }
  .bg-light { background-color: var(--color-neutral-50); }
  
  .bg-dark { background-color: var(--color-primary-900); }
  .text-white { color: white !important; }
  .text-white-50 { color: rgba(255,255,255,0.7) !important; }

  .about-section {
    padding-top: var(--space-20);
  }

  #agenda {
    padding-top: var(--space-10); /* Reducir espacio superior */
  }

  .lead {
    font-size: var(--font-size-xl);
    font-weight: 500;
    color: var(--color-text-primary); /* White text for dark background */
    margin-bottom: var(--space-6);
    line-height: var(--line-height-relaxed);
  }

  .rounded-image {
    border-radius: var(--radius-2xl);
    box-shadow: var(--shadow-xl);
    transform: rotate(2deg);
    border: 8px solid white;
    max-height: 400px;
    object-fit: cover;
    width: 100%;
  }

  .about-grid {
    align-items: center;
  }

  /* Gallery Grid Mosaic */
  .gallery-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: repeat(3, 200px);
    gap: var(--space-4);
  }

  @media (min-width: 768px) {
    .gallery-grid {
      grid-template-columns: repeat(4, 1fr);
      grid-template-rows: repeat(2, 250px);
    }
  }

  .gallery-item {
    overflow: hidden;
    border-radius: var(--radius-lg);
    position: relative;
  }
  
  .agenda-card .card-image {
    aspect-ratio: 4/5; /* Formato flyer vertical */
    overflow: hidden;
    background-color: var(--color-neutral-900); /* Fondo oscuro para el relleno */
  }

  .agenda-card .card-image img {
    width: 100%;
    height: 100%;
    object-fit: contain; /* Mostrar imagen completa */
    transition: transform 0.5s ease;
  }

  .agenda-card:hover .card-image img {
    transform: scale(1.03);
  }

  .agenda-card .card-content {
    padding: var(--space-4);
    background-color: var(--color-surface);
  }

  .agenda-card .card-title {
    font-size: var(--font-size-lg);
    margin-bottom: var(--space-2);
  }
  
  .mt-4 { margin-top: var(--space-4); }

  .btn-outline {
    display: inline-block;
    padding: var(--space-2) var(--space-4);
    border: 1px solid var(--color-accent-400);
    color: var(--color-accent-400);
    text-decoration: none;
    border-radius: var(--radius-md);
    font-weight: 600;
    transition: all 0.3s;
    text-align: center;
  }

  .btn-outline:hover {
    background-color: var(--color-accent-400);
    color: var(--color-neutral-900);
  }

  .centered-btn {
    display: block;
    margin-left: auto;
    margin-right: auto;
    width: fit-content;
    min-width: 200px;
  }
  
  .gallery-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .gallery-item:hover img {
    transform: scale(1.1);
  }

  .item-1 { grid-area: 1 / 1 / 3 / 3; } /* Large item */

  .placeholder-gallery {
    width: 100%;
    height: 100%;
    background-color: rgba(255,255,255,0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.1em;
  }
</style>
