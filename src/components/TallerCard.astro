---
import { Image } from 'astro:assets';
import type { CollectionEntry } from "astro:content";

interface Props {
  taller: CollectionEntry<"talleres">;
}

const { taller } = Astro.props;
const { data, slug } = taller;
---

<article class="card taller-card">
  <div class={`card-image ${data.isFlyer ? 'flyer-mode' : ''}`}>
    {data.imagen ? (
      <Image src={data.imagen} alt={`Taller de ${data.titulo}`} />
    ) : (
      <div class="placeholder-image">
        <span>{data.titulo}</span>
      </div>
    )}
  </div>
  <div class="card-content">
    <h3 class="card-title">{data.titulo}</h3>
    <div class="card-meta">
      <span class="meta-item">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
        {data.horarios}
      </span>
      <span class="meta-item">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
        {data.edadNivel}
      </span>
      { data.info_docente?.nombre && (
        <span class="meta-item">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
          {data.info_docente.nombre}
        </span>
      )}
    </div>
    <p class="card-description">{data.descripcion}</p>
    <a href={`/talleres/${slug}`} class="btn btn-primary full-width">Ver Taller</a>
  </div>
</article>

<style>
  .taller-card {
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .card-image {
    aspect-ratio: 16/9;
    overflow: hidden;
    background-color: var(--color-neutral-100);
  }

  .card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .card-image.flyer-mode {
    background-color: var(--color-primary-950); /* Dark background for posters */
  }

  .card-image.flyer-mode img {
    object-fit: contain;   /* Show full poster */
  }

  .taller-card:hover .card-image img {
    transform: scale(1.05);
  }

  .placeholder-image {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: var(--color-primary-100);
    color: var(--color-primary-700);
    font-weight: bold;
    font-size: 1.2rem;
  }

  .card-content {
    padding: var(--space-6);
    display: flex;
    flex-direction: column;
    flex-grow: 1;
  }
.card {
  background: var(--color-surface);
  border-radius: var(--radius-xl);
  overflow: hidden;
  box-shadow: var(--shadow-md);
  transition: all var(--transition-normal);
  border: 1px solid transparent;
}

.card:hover {
  transform: translateY(-8px);
  box-shadow: var(--shadow-xl);
  border-color: var(--color-primary-200);
}
  .card-meta {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    margin-bottom: var(--space-4);
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
  }

  .meta-item {
    display: flex;
    align-items: center;
    gap: var(--space-2);
  }

  .card-title {
    font-size: var(--font-size-xl);
    margin-bottom: var(--space-2);
    color: var(--color-text-primary);
    overflow-wrap: break-word;
    word-break: break-word;
  }

  .card-description {
    margin-bottom: var(--space-6);
    line-height: 1.5;
    flex-grow: 1;
    overflow-wrap: anywhere;
    word-break: normal;
  }

  .full-width {
    width: 100%;
    text-align: center;
  }
</style>
